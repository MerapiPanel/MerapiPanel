(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function a(a){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){var n,i,c,d;n=a,i=t,c=o[t],d=function(t,a){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i),(i="symbol"==e(d)?d:d+"")in n?Object.defineProperty(n,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[i]=c})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))}))}return a}var n=window.__,o=n.Article;o.config||(o.config={payload:{page:1,limit:10,search:""},roles:{modify:!0}}),o.config.roles||(o.config.roles={}),o.config.payload||(o.config.payload={page:1,limit:10,search:""});var i=a(a({},{modify:!0}),o.config.roles),c=o.endpoints,d=o.config.payload;$("#panel-subheader-search").on("submit",(function(e){e.preventDefault(),d.page=1,d.search=$(this).find("input").val(),o.render()})),o.render=function(){if(this instanceof HTMLElement&&(o.el=this),!c.fetchAll)throw new Error("Please provide an endpoint to fetch all articles");n.http.get(c.fetchAll,d).then((function(e){var t=e.data,r=t.articles,l=t.totalPages,s=t.totalResults;if(d.page>l)return d.page=l,o.render();$("#total-records").text("Total Records: ".concat(s)),function(e,t,a){$(e).html("");var n=Math.max(1,t-3),i=Math.min(a,t+3);i-n<6&&(1===n?i=Math.min(a,n+6):i===a&&(n=Math.max(1,i-6))),t>1&&$(e).append('<li class="page-item"><a class="page-link" href="#" data-page="1">&laquo;</a></li>');for(var c=n;c<=i;c++){var r=c===t?"page-item active":"page-item";$(e).append($('<li class="'+r+'"><a class="page-link" href="#" data-page="'+c+'">'+c+"</a></li>"))}t<a&&$(e).append('<li class="page-item"><a class="page-link" href="#" data-page="'+a+'">&raquo;</a></li>'),$(e).find("a.page-link").on("click",(function(e){e.preventDefault(),d.page=parseInt($(this).data("page")),o.render()}))}($("#pagination"),d.page,l),setTimeout((function(){(r||[]).length>0?$(o.el).html("").append((r||[]).map((function(e){return function(e){var t=$("<div class='card card-body border-0 shadow-sm d-flex flex-column position-relative' style='width: 100%; max-width: 30rem;'>").append($("<div class='flex-grow-1'>").append($("<div class='d-flex'>").append(e.status?'<i class="fa-solid fa-earth-americas"></i>':'<i class="fa-solid fa-lock"></i>').append($('<h5 class="ms-1 card-title">'.concat(e.title||"No Title","</h5>")))).append("<p>".concat(e.description||'<span class="text-muted opacity-50">No Description</span>',"</p>"))).append($("<div>").append($("<button class='btn btn-sm btn-primary px-5 mb-2'>View</button>").on("click",(function(){c.view?window.location.href=c.view.replace("{id}",e.id):n.toast("No view endpoint found",5,"text-danger")}))).append($("<div class='d-flex gap-3 text-muted'>").append("<span>Update: ".concat(e.update_date||"No Date","</span>")).append("<span class='ms-auto'>".concat(e.author_name||"No Author","</span>")))).append(1==i.modify?$("<div class='dropdown position-absolute top-0 end-0'>").append($('<button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">').append('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">')).append($('<div class="dropdown-menu dropdown-menu-end">').append($('<a class="dropdown-item" href="#">Edit</a>').on("click",(function(){c.edit?window.location.href=c.edit.replace("{id}",e.id):n.toast("No edit URL found",5,"text-danger")}))).append($('<a class="dropdown-item" href="#">Quick Edit</a>').on("click",(function(){return function(e){var t=null;$("#quick-edit-modal").length>0?t=n.modal.from($("#quick-edit-modal")):(t=n.modal.create("Edit Article","")).el.attr("id","quick-edit-modal"),t.dismiss=null,t.clickOut=!1,t.action.negative=function(){t.hide()};var i=$('<form class="needs-validation">').append($("<div>").append($("<label class='mb-3 d-block'>").append("Title : ").append('<input type="text" class="form-control" name="title" pattern="[a-zA-Z\\s]{5,}" value="'.concat(e.title||"",'">')).append('<div class="invalid-feedback">Please enter a title</div>')).append($("<label class='mb-3 d-block'>").append("Slug : ").append('<input type="text" class="form-control" name="slug" value="'.concat(e.slug||"",'">')).append('<div class="invalid-feedback">Please enter a slug</div>')).append($("<label class='mb-3 d-block'>").append("Keywords : ").append('<input type="text" class="form-control" name="keywords" value="'.concat(e.keywords||"",'">')).append('<div class="invalid-feedback">Please enter a keywords</div>')).append($("<label class='mb-3 d-block'>").append("Description : ").append('<textarea class="form-control" name="description">'.concat(e.description||"","</textarea>")).append('<div class="invalid-feedback">Please enter a description</div>')).append($("<label class='mb-3 d-block'>").append("Category : ").append('<input type="text" class="form-control" name="category" value="'.concat(e.category||"",'">')).append('<div class="invalid-feedback">Please enter a category</div>')).append($("<label class='mb-3 d-block form-check'>").append('<input class=\'form-check-input\' type="checkbox" name="status" '.concat(e.status?"checked":"",">")).append("<span class='form-check-label'>Publish</span>")));t.content=i,t.show(),t.action.positive=function(){if(i[0].checkValidity()){var t=a(a({},e),i.serializeArray().reduce((function(e,t){return e[t.name]=t.value,"status"===t.name&&(e[t.name]="on"===t.value?1:0),e}),{status:0}));c.update||n.toast("No update endpoint found",5,"text-danger"),n.http.post(c.update,t).then((function(e){200===e.code?(n.toast("Article updated",5,"text-success"),o.render()):n.toast(e.message||"Failed to update article",5,"text-danger")})).catch((function(e){n.toast(e.message||"Failed to update article",5,"text-danger")}))}else i[0].reportValidity()}}(e)}))).append($('<a class="dropdown-item text-danger" href="#">Delete</a>').on("click",(function(){return function(e){n.dialog.danger("Are you sure?",$("<div>").append($("<div>Are you sure you want to delete this article?</div>").append($("<div class='py-3'>").append("<div class='fw-bold'>".concat(e.title,"</div>")).append("<div class='text-primary text-opacity-75'>".concat(e.id,"</div>")))).append("<p class='text-danger'>This action cannot be undone.</p>")).then((function(){c.delete?n.http.post(c.delete,{id:e.id}).then((function(e){200==e.code?(n.toast("Article deleted",5,"text-success"),o.render()):n.toast(e.message||"Failed to delete article",5,"text-danger")})).catch((function(e){n.toast(e.message||"Failed to delete article",5,"text-danger")})):n.toast("No delete endpoint found",5,"text-danger")})).catch((function(){n.toast("Action cancelled",5,"text-info")}))}(e)})))):"");return t}(e)}))):$(o.el).html("").append($("<div class='text-muted text-center w-100 py-5 my-5 fs-2'>No articles found</div>"))}),600)})).catch((function(e){n.toast(e.message||"Something went wrong",5,"text-danger")}))}})();