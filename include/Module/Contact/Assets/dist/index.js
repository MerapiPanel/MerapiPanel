(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function n(n){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?t(Object(o),!0).forEach((function(t){var a,r,d,i;a=n,r=t,d=o[t],i=function(t,n){if("object"!=e(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var o=a.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r),(r="symbol"==e(i)?i:i+"")in a?Object.defineProperty(a,r,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[r]=d})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}))}return n}var a=window.__,o=a.Contact,r=$('<form class="needs-validation">').append($('<div class="form-group mb-3">').append($('<label for="name" class="form-label w-100">Name</label>').append($('<input type="text" class="form-control" id="name" placeholder="Enter name" required>')))).append($('<div class="form-group mb-3">').append($('<label for="type" class="form-label w-100">Type</label>').append($('<select class="form-select" id="type">').append($('<option value="phone">Phone</option>'),$('<option value="email">Email</option>'),$('<option value="whatsapp">Whatsapp</option>'))))).append($('<div class="form-group mb-3">').append($('<label for="address" class="form-label w-100" for="address">Phone</label>'),$('<input type="text" class="form-control" id="address" name="address" pattern="^[+]?[(]?[0-9]{3}[)]?[-s.]?[0-9]{3}[-s.]?[0-9]{4,12}$" placeholder="Enter phone number" required>'),$('<div class="invalid-feedback">Invalid phone number</div>'))),d={phone:"Enter phone number",email:"Enter email address",whatsapp:"Enter whatsapp number"},i={phone:"Phone",email:"Email",whatsapp:"Whatsapp"},l={phone:"^[+]?[(]?[0-9]{3}[)]?[-\\s.]?[0-9]{3}[-\\s.]?[0-9]{4,12}$",email:"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$",whatsapp:"^[+]?[(]?[0-9]{3}[)]?[-\\s.]?[0-9]{3}[-\\s.]?[0-9]{4,12}$"},s={phone:"Invalid phone number",email:"Invalid email address",whatsapp:"Invalid whatsapp number"},p={phone:'<i class="fa-solid fa-phone fa-xl me-2"></i>',email:'<i class="fa-solid fa-envelope fa-xl me-2"></i>',whatsapp:'<i class="fa-brands fa-whatsapp fa-xl me-2"></i>'};o.config||(o.config={}),o.config.roles||(o.config.roles={});var c=n(n({},{create:!1,update:!1,delete:!1}),o.config.roles),f={"contact-type":$("#filter-contact").val()||null};function u(e){return $('<li class="list-group-item position-relative">').append($('<div class="d-flex justify-content-start align-items-center">').append(p[e.type],$('<div class="ms-3">').append($('<h5 class="mb-1" title="'.concat(e.is_default?"Default contact":"",'">')).append(e.name).append(e.is_default?$('<i class="fa-solid fa-star ms-1 text-warning"></i>'):""),$('<p class="mb-0 text-muted">').append(e.address).css({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:"0.8rem"})))).append(c.update||c.delete?$('<div class="dropdown position-absolute top-0 end-0">').append($('<button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">'),$('<ul class="dropdown-menu dropdown-menu-end">').append(c.update?$('<li class="dropdown-item" type="button">').append("Edit").on("click",(function(){return o.edit(e)})):"",c.delete?$('<li class="dropdown-item text-danger" type="button">').append("Delete").on("click",(function(){return o.delete(e)})):"",c.update?$('<li class="dropdown-item" type="button">').append("Set as default").on("click",(function(){return o.default(e)})):"")):"")}$("#filter-contact").on("change",(function(){f["contact-type"]=$(this).val(),o.render()})),o.render=function(){this instanceof HTMLElement&&(o.el=this),o.fetchURL?a.http.post(o.fetchURL,f).then((function(e){e.data&&0!==e.data.length?$(o.el).html("").append(e.data.map(u)):$(o.el).html("").append($('<div class="d-flex justify-content-center align-items-center">').css({minHeight:"40vh"}).append($('<h3 class="fs-3 fw-semibold text-muted">').append('<i class="fa-solid fa-quote-left fa-xl me-2"></i>').append("No contacts found")))})).catch((function(e){a.toast(e.message||"Something went wrong",5,"text-danger")})):a.toast("No fetch URL found",5,"text-danger")},o.add=function(){var e=$("#modal-add-contact").length?a.modal.from($("#modal-add-contact")):a.modal.create("Add Contact",r.clone());$(e.el).prop("id","modal-add-contact"),$(e.el).find("#type").on("change",(function(){var t=$(this).val(),n=$(e.el).find("#address");n.parent("label").text(i[t]||"Address"),n.prop("placeholder",d[t]||"Enter address"),n.prop("pattern",l[t]||"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"),n.parent("div").find(".invalid-feedback").text(s[t]||"Invalid address"),n.trigger("input")})),$(e.el).find("#type").trigger("change"),e.show(),e.action.positive={text:"add contact",callback:function(){var t,n=e.el.find("form").get(0);if(!n.checkValidity())return n.reportValidity(),void a.toast("Invalid form",5,"text-danger");var r=$(n).find("#type").val(),d=$(n).find("#name").val(),i=$(n).find("#address").val();null===(t=o.fire("add",{name:d,address:i,type:r}))||void 0===t||null===(t=t.then((function(){e.hide(),o.render(),n.reset()})))||void 0===t||t.catch((function(e){a.toast(e.message||"Something went wrong",5,"text-danger")}))}}},o.edit=function(e){var t=$("#modal-edit-contact").length?a.modal.from($("#modal-edit-contact")):a.modal.create("Edit Contact",r.clone());$(t.el).prop("id","modal-edit-contact"),$(t.el).find("#type").on("change",(function(){var e=$(this).val(),n=$(t.el).find("#address");n.parent("label").text(i[e]||"Address"),n.prop("placeholder",d[e]||"Enter address"),n.prop("pattern",l[e]||"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"),n.parent("div").find(".invalid-feedback").text(s[e]||"Invalid address"),n.trigger("input")})),$(t.el).find("#name").val(e.name),$(t.el).find("#type").val(e.type).trigger("change"),$(t.el).find("#address").val(e.address),t.show(),t.action.positive={text:"update contact",callback:function(){var n,r=t.el.find("form").get(0);if(!r.checkValidity())return r.reportValidity(),void a.toast("Invalid form",5,"text-danger");var d=$(r).find("#type").val(),i=$(r).find("#name").val(),l=$(r).find("#address").val();null===(n=o.fire("update",{name:i,address:l,type:d,id:e.id}))||void 0===n||null===(n=n.then((function(){t.hide(),o.render(),r.reset()})))||void 0===n||n.catch((function(e){a.toast(e.message||"Something went wrong",5,"text-danger")}))}}},o.delete=function(e){var t="Are you sure you want to delete <b>".concat(e.name,"</b>?");a.dialog.danger("Are you sure ?",t).then((function(){var t;null===(t=o.fire("delete",e))||void 0===t||null===(t=t.then((function(){o.render()})))||void 0===t||t.catch((function(e){a.toast(e.message||"Something went wrong",5,"text-danger")}))}))},o.default=function(e){var t;null===(t=o.fire("default",e))||void 0===t||null===(t=t.then((function(){o.render()})))||void 0===t||t.catch((function(e){a.toast(e.message||"Something went wrong",5,"text-danger")}))}})();