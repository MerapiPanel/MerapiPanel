(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function a(a){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){var n,o,r,l;n=a,o=t,r=i[t],l=function(t,a){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o),(o="symbol"==e(l)?l:l+"")in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(i,e))}))}return a}var n=window.__,i=n.MProduct;i.config||(i.config={payload:{page:1,limit:10,search:""},roles:{modify:!0}}),i.config.roles||(i.config.roles={}),i.config.payload||(i.config.payload={page:1,limit:10,search:""});var o=a(a({},{modify:!0}),i.config.roles),r=i.config.payload;function l(e){var t=a({currency:"USD",currency_symbol:"$"},i.config||{}),r=$("<div class='card position-relative w-100' style='max-width: 12rem;'>").css("min-width",window.innerWidth<576?"12rem":"18rem").append(e.images?$("<div id='carousel-".concat(e.id,'\' class="carousel slide carousel-fade" data-bs-ride="carousel" onload="this.init()">')).append($("<div class='carousel-inner'>").append(e.images.map((function(e,t){return $("<div class='carousel-item".concat(0===t?" active":"","' data-bs-interval=\"").concat(3e3*Math.random()+3e3,'">')).append($("<img class='d-block w-100' src='".concat(e,"' style='height: 200px;object-fit: cover;'>")))})))):$("<div class='carousel-item'>").append($("<div>No images</div>"))).append($("<div class='card-body'>").append($("<h5 class='card-title'>".concat(e.title,"</h5>"))).append($("<p class='card-text'>".concat((e.description||"").length>100?(e.description||"").slice(0,75)+"...":e.description,"</p>"))).append($("<div><span class='fw-semibold'>".concat(t.currency_symbol," ").concat(e.price,"</span> | <i class='fw-light'>").concat(e.category,"</i></div>")))).append(1==o.modify?$("<div class='dropdown position-absolute end-0 top-0' style='z-index: 1;' role='dropdown'>").append("<button class='btn dropdown-toggle' type='button' data-bs-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>Action</button>").append($("<div class='dropdown-menu dropdown-menu-end' aria-labelledby='dropdownMenuButton'>").append($("<a class='dropdown-item' href='#'>View</a>").on("click",(function(){return function(e){window.location.href=n.endpoints.view.replace("{id}",e.id)}(e)}))).append($("<a class='dropdown-item' href='#'>Quick Edit</a>").on("click",(function(){return function(e){var t=$("<form class='row g-3 needs-validation'>").append($("<div class='form-group'>").append($("<label class='form-label'>Title</label>")).append("<input type='text' class='form-control' name='title' placeholder='Enter title' value='".concat(e.title,"' pattern='[a-zA-Z0-9\\s]{3,255}' required>")).append($("<div class='invalid-feedback'>Please provide a valid title, at least 3 characters.</div>")).append($("<div class='valid-feedback'>Looks good!</div>")),$("<div class='form-group'>").append($("<label class='form-label'>Price</label>")).append($("<input type='text' class='form-control' name='price' placeholder='Enter price' inputmode='numeric' pattern='[0-9.]*' maxlength='24' value='".concat(e.price,"'>")).on("input",(function(){$(this).val(($(this).val()||"").replace(/[^0-9]/g,"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1."))}))).append($("<div class='invalid-feedback'>Please enter number only.</div>")).append($("<div class='valid-feedback'>Looks good!</div>")),$("<div class='form-group'>").append($("<label class='form-label'>Category</label>")).append("<input type='text' class='form-control' name='category' placeholder='Enter category' pattern='[a-zA-Z]{3,24}[a-zA-Z0-9\\s]{0,24}' required value='".concat(e.category,"'>")).append("<div class='invalid-feedback'>Please provide a valid category, at least 3 characters.</div>").append("<div class='valid-feedback'>Looks good!</div>"),$("<div class='form-group'>").append($("<label class='form-label'>Description</label>")).append($("<textarea class='form-control' name='description' placeholder='Enter description' rows='3' minlength='30' maxlength='255' required>".concat(e.description,"</textarea>")).on("input",(function(){$(this).parent(".form-group").find(".length").text($(this).val().length+"/255")}))).append("<small class='length'>".concat(e.description.length,"/255</small>")).append("<div class='valid-feedback'>Looks good!</div>"),$("<div class='form-group'>").append($("<label class='form-label'>Status</label>")).append($("<select class='form-select' name='status'>").append($("<option value='1' ".concat(1===e.status?"selected":"",">Publish</option>")),$("<option value='0' ".concat(0===e.status?"selected":"",">Unpublish</option>"))))),a=$("#modal-quick-edit").length?n.modal.from($("#modal-quick-edit")):n.modal.create("Quick Edit",null);a.content=t,a.show(),a.action.positive=function(){t[0].checkValidity()?n.http.post(i.endpoints.update,{id:e.id,title:t.find("input[name='title']").val(),price:t.find("input[name='price']").val(),category:t.find("input[name='category']").val(),description:t.find("textarea[name='description']").val(),status:t.find("select[name='status']").val()}).then((function(e){if(200!==e.code)throw new Error(e.message);n.toast("Product updated",5,"text-success"),i.render()})).catch((function(e){n.toast(e.message||"Failed to update product",5,"text-danger")})):n.toast("Please check your form",5,"text-danger")}}(e)}))).append($("<a class='dropdown-item' href='#'>Edit</a>").on("click",(function(){return function(e){window.location.href=i.endpoints.edit.replace("{id}",e.id)}(e)}))).append($("<a class='dropdown-item' href='#'>Delete</a>").on("click",(function(){return function(e){var t=$("<div>").append("<p>Are you sure want to delete this product?</p>").append("<p>Details as below</p>").append($("<table class='table table-bordered'>").append($("<tr style='vertical-align: baseline;'>").append("<td>id</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.id||"","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>title</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.title||"","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>price</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.price||0,"</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>category</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.category||"","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>description</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.description||"","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>status</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(1===e.status?"Publish":"Unpublish","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>post_date</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.post_date||"-","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>update_date</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.update_date||"-","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>author_id</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.author_id||"-","</p></td>")),$("<tr style='vertical-align: baseline;'>").append("<td>author_name</td>").append('<td><p style="word-break: break-all; margin:0;">'.concat(e.author_name||"-","</p></td>"))));n.dialog.danger("Are you sure?",t).then((function(){n.http.post(i.endpoints.delete,{id:e.id}).then((function(e){if(200!==e.code)throw new Error(e.message);n.toast("Success delete product",5,"text-success"),i.render()})).catch((function(){n.toast("Failed to delete product",5,"text-danger")}))})).catch((function(){n.toast("Action cancelled",5,"text-info")}))}(e)})))):"");try{r.find(".carousel")[0].init=function(){if(window.bootstrap){var e=new window.bootstrap.Carousel(this);$(this).on("destroyed",(function(){return e.dispose()}))}}}catch(e){console.log(e)}return r}$("#panel-subheader-search").on("submit",(function(e){e.preventDefault(),r.page=1,r.search=$(this).find("input").val(),i.render()})),i.render=function(){this instanceof HTMLElement&&(i.el=this),n.http.get(i.endpoints.fetchAll,r).then((function(e){var t=e.data,a=t.products,n=t.totalResults,o=t.totalPages;if(r.page>o)return r.page=o,i.render();$("#total-records").text("Total Records: ".concat(n)),function(e,t,a){$(e).html("");var n=Math.max(1,t-3),o=Math.min(a,t+3);o-n<6&&(1===n?o=Math.min(a,n+6):o===a&&(n=Math.max(1,o-6))),t>1&&$(e).append('<li class="page-item"><a class="page-link" href="#" data-page="1">&laquo;</a></li>');for(var l=n;l<=o;l++){var d=l===t?"page-item active":"page-item";$(e).append($('<li class="'+d+'"><a class="page-link" href="#" data-page="'+l+'">'+l+"</a></li>"))}t<a&&$(e).append('<li class="page-item"><a class="page-link" href="#" data-page="'+a+'">&raquo;</a></li>'),$(e).find("a.page-link").on("click",(function(e){e.preventDefault(),r.page=parseInt($(this).data("page")),i.render()}))}($("#pagination"),r.page,o),setTimeout((function(){$(i.el).html("").append((a||[]).map(l)),0===(a||[]).length&&$(i.el).html("").css({position:"relative",flex:"1"}).append($("<div>No data found</div>").css({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"}))}),400)})).catch((function(e){n.toast(e instanceof String?e:e.message||"Error on rendering data",5,"text-danger")}))}})();