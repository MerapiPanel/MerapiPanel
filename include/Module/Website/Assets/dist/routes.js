(()=>{"use strict";var e=window.__;function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=$('<div id="content" class="row row-cols-1 row-cols-md-2 g-4"></div>'),a=$("#modal-select-template").length<=0?e.modal.create("Select Template",l):e.modal.from($("#modal-select-template"));function n(e){return $('<label class="col d-flex align-items-center" style="max-width: 14rem; gap: 1rem;">').append($('<input type="radio" name="template" value="'.concat(e.id,'" ').concat(t==e.id?"checked":"",">")),$('<div class="card card-body">').append($('<h5 class="card-title">'.concat(e.title,"</h5>"))).append($('<small class="card-text">'.concat(e.description||'<span class="text-muted">No description</span>',"</small>"))))}a.el.prop("id","modal-select-template"),a.show(),a.el.find("#content").append($("<div id='loading-container'>").css({height:"150px",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:0,left:0,zIndex:5}).append('<i class="fa-solid fa-spinner fa-spin fa-2x"></i>'));var i=[];return e.http.get(e.routes.templateFetchURL,{}).then((function(e){i=e.data,a.el.find("#content").html("").append(i.map(n))})),new Promise((function(t,l){a.action.positive={text:"Select",callback:function(){var l=a.el.find('input[name="template"]:checked').val();if(l){var n=i.find((function(e){return e.id==l}));t(n),a.hide()}else e.toast("Please select a template",5,"text-danger")}}}))}e.routes={templateFetchURL:null,render:function(t,l){function a(t){return $('<li class="mb-3">').append($('<div class="d-flex align-items-end flex-wrap'.concat(null===t.id?" text-primary":"",'">')).append($("<div>").append("<b>".concat(t.title,"</b>")).append($('<small class="text-primary d-block" style="cursor:pointer">'.concat(n(t.route),"</small>")).on("click",(function(){window.open(n(t.route),"_blank")})))).append(null===t.id?"":$('<div class="ms-auto btn-group" role="group" aria-label="Basic example">').append(null===t.template_id?"":$('<button type="button" class="btn btn-sm px-4 btn-outline-primary">Edit Template</button>').on("click",(function(){e.routes.fire("editTemplate",t)})),$('<button type="button" class="btn btn-sm px-4 btn-outline-primary">Edit</button>').on("click",(function(){e.routes.fire("pre:edit",t).cancelBubble||e.routes.edit(t)})),$('<button type="button" class="btn btn-sm px-4 btn-outline-danger">Delete</button>').on("click",(function(){e.routes.delete(t)})))))}function n(e){return window.location.protocol+"//"+window.location.host+(47===e.charCodeAt(0)?e:"/"+e)}e.http.get(l,{}).then((function(e){$(t).html("").append(e.data.map(a))}))},add:function(){var l,a=$("<form class='needs-validation'>").append($('<div class="form-group mb-3">').append('<label for="title">Title</label>').append('<input type="text" class="form-control" id="title" placeholder="Enter title" required/>').append('<div class="invalid-feedback">Please provide a valid title.</div>')).append($('<div class="form-group mb-3">').append('<label for="template">Template</label>').append($('<select type="text" class="form-select" id="template"></select>').append($('<option value="">-- Select Template --</option>')))).append($('<div class="form-group mb-3">').append('<label for="route">Route</label>').append('<input type="text" class="form-control" id="route" placeholder="Enter route" required/>').append('<div class="invalid-feedback">Please provide a valid route.</div>')),n=$("#modal-add-route").length<=0?e.modal.create("Add Route",a):e.modal.from($("#modal-add-route"));return n.el.prop("id","modal-add-route"),n.show(),$(n.el).find("#title").on("input",(function(){var e;$(n.el).find("#route").val("/"+(null===(e=$(this).val())||void 0===e||null===(e=e.replace(/[^a-zA-Z0-9_]+/g,"-"))||void 0===e||null===(e=e.toLowerCase())||void 0===e||null===(e=e.replace(/-$/g,""))||void 0===e?void 0:e.replace(/^-/,"")))})),$(n.el).find("#route").on("input",(function(){var e,t=this,a="/"+(null===(e=$(this).val())||void 0===e||null===(e=e.replace(/[^a-zA-Z0-9_]+/g,"-"))||void 0===e||null===(e=e.toLowerCase())||void 0===e||null===(e=e.replace(/^-/,""))||void 0===e?void 0:e.replace(/\\|\/$/g,""));$(this).val(a),l&&clearTimeout(l),l=setTimeout((function(){var e;$(t).val(null===(e=$(t).val())||void 0===e?void 0:e.replace(/-$/g,""))}),1e3)})),$(n.el).find("#template").on("click",(function(e){e.preventDefault(),e.currentTarget.blur(),t().then((function(e){n.el.find("#template").html("").append('<option value="'.concat(e.id,'" selected>').concat(e.title,"</option>"))}))})),new Promise((function(t,l){n.on("modal:hide",(function(){l()})),n.action.positive=function(){var l=n.el.find("#title").val(),a=n.el.find("#route").val(),i=n.el.find("#template").val();n.el.find("form").get(0).checkValidity()?!l||(l||"").length<=0?e.toast("Title is required",5,"text-danger"):!a||(a||"").length<=0?e.toast("Route is required",5,"text-danger"):(t({title:l,route:a,template:i}),n.hide(),n.el.find("form").get(0).reset()):e.toast("Form is not valid",5,"text-danger")}}))},edit:function(l){var a,n=$('<form class="needs-validation">').append($('<div class="form-group mb-3">').append('<label for="id">id</label>').append('<input type="text" class="form-control" id="id" placeholder="Enter id" value="'.concat(l.id,'" readonly/>'))).append($('<div class="form-group mb-3">').append('<label for="title">Title</label>').append('<input type="text" class="form-control" id="title" placeholder="Enter title" value="'.concat(l.title,'" required/>')).append('<div class="invalid-feedback">Please provide a valid title.</div>')).append($('<div class="form-group mb-3">').append('<label for="template">Template</label>').append($('<select type="text" class="form-select" id="template"></select>').append($('<option value="'.concat(l.template_id,'">').concat(l.template_title,"</option>"))))).append($('<div class="form-group mb-3">').append('<label for="route">Route</label>').append('<input type="text" class="form-control" id="route" placeholder="Enter route" value="'.concat(l.route,'" ').concat("/"==l.route?"disabled":""," required/>")).append('<div class="invalid-feedback">Please provide a valid route.</div>')),i=$("#modal-edit-route").length<=0?e.modal.create("Edit Route",n):e.modal.from($("#modal-edit-route"));i.el.prop("id","modal-edit-route"),i.show(),i.el.find("#id").val(l.id),i.el.find("#title").val(l.title),i.el.find("#route").val(l.route),$(i.el).find("#title").on("input",(function(){var e;$(i.el).find("#route").val("/"+(null===(e=$(this).val())||void 0===e||null===(e=e.replace(/[^a-zA-Z0-9_]+/g,"-"))||void 0===e||null===(e=e.toLowerCase())||void 0===e||null===(e=e.replace(/-$/g,""))||void 0===e?void 0:e.replace(/^-/,"")))})),$(i.el).find("#route").on("input",(function(){var e,t=this,l="/"+(null===(e=$(this).val())||void 0===e||null===(e=e.replace(/[^a-zA-Z0-9_]+/g,"-"))||void 0===e||null===(e=e.toLowerCase())||void 0===e||null===(e=e.replace(/^-/,""))||void 0===e?void 0:e.replace(/\\|\/$/g,""));$(this).val(l),a&&clearTimeout(a),a=setTimeout((function(){var e;$(t).val(null===(e=$(t).val())||void 0===e?void 0:e.replace(/-$/g,""))}),1e3)})),$(i.el).find("#template").on("click",(function(e){e.preventDefault(),e.currentTarget.blur(),t(l.template).then((function(e){i.el.find("#template").html("").append('<option value="'.concat(e.id,'" selected>').concat(e.title,"</option>"))}))})),i.on("modal:hide",(function(){i.el.find("input").each((function(){$(this).val("").removeClass("is-valid is-invalid")}))})),i.action.positive=function(){var t=i.el.find("#id").val(),l=i.el.find("#title").val(),a=i.el.find("#route").val(),n=i.el.find("#template").val();i.el.find("form").get(0).checkValidity()?!t||(t||"").length<=0?e.toast("id is required",5,"text-danger"):!l||(l||"").length<=0?e.toast("Title is required",5,"text-danger"):!a||(a||"").length<=0?e.toast("Route is required",5,"text-danger"):(e.routes.fire("edit",{id:t,title:l,route:a,template:n}),i.hide(),i.el.find("form").get(0).reset()):e.toast("Provide a valid form",5,"text-danger")}},delete:function(t){e.dialog.danger("Are you sure?","Are you sure to delete this route <b>"+t.title+"</b> with id <i>"+t.id+"</i>").then((function(){e.routes.fire("delete",t)})).catch((function(){e.toast("Cancelled",5,"text-warning")}))},callbacks:{},on:function(t,l){e.routes.callbacks[t]||(e.routes.callbacks[t]=[]),e.routes.callbacks[t].push(l)},fire:function(t){for(var l=arguments.length,a=new Array(l>1?l-1:0),n=1;n<l;n++)a[n-1]=arguments[n];var i=new Event(t);return e.routes.callbacks[t]&&e.routes.callbacks[t].forEach((function(e){i.cancelBubble||e.apply(void 0,[i].concat(a))})),i}}})();